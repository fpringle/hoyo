<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : HoYo.Internal.Command
Copyright   : (c) Frederick Pringle, 2023
License     : BSD-3-Clause
Maintainer  : freddyjepringle@gmail.com

Internals used by the HoYo.Command module.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HoYo.Internal.Command</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HoYo.Bookmark.html"><span class="hs-identifier">HoYo.Bookmark</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HoYo.Config.html"><span class="hs-identifier">HoYo.Config</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html"><span class="hs-identifier">HoYo.Internal.Types</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HoYo.Internal.Utils.html"><span class="hs-identifier">HoYo.Internal.Utils</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isDigit</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Extras</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | Options for the &quot;add&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span> </span><span id="AddOptions"><span class="annot"><a href="HoYo.Internal.Command.html#AddOptions"><span class="hs-identifier hs-var">AddOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AddOptions"><span class="annot"><a href="HoYo.Internal.Command.html#AddOptions"><span class="hs-identifier hs-var">AddOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-40"></span><span>  </span><span id="addDirectory"><span class="annot"><span class="annottext">AddOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#addDirectory"><span class="hs-identifier hs-var hs-var">addDirectory</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="addName"><span class="annot"><span class="annottext">AddOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#addName"><span class="hs-identifier hs-var hs-var">addName</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093288"><span id="local-6989586621679093290"><span id="local-6989586621679093292"><span class="annot"><span class="annottext">Int -&gt; AddOptions -&gt; ShowS
[AddOptions] -&gt; ShowS
AddOptions -&gt; String
(Int -&gt; AddOptions -&gt; ShowS)
-&gt; (AddOptions -&gt; String)
-&gt; ([AddOptions] -&gt; ShowS)
-&gt; Show AddOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AddOptions] -&gt; ShowS
$cshowList :: [AddOptions] -&gt; ShowS
show :: AddOptions -&gt; String
$cshow :: AddOptions -&gt; String
showsPrec :: Int -&gt; AddOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; AddOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093283"><span id="local-6989586621679093285"><span class="annot"><span class="annottext">AddOptions -&gt; AddOptions -&gt; Bool
(AddOptions -&gt; AddOptions -&gt; Bool)
-&gt; (AddOptions -&gt; AddOptions -&gt; Bool) -&gt; Eq AddOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AddOptions -&gt; AddOptions -&gt; Bool
$c/= :: AddOptions -&gt; AddOptions -&gt; Bool
== :: AddOptions -&gt; AddOptions -&gt; Bool
$c== :: AddOptions -&gt; AddOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- | Options for the &quot;move&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">newtype</span><span> </span><span id="MoveOptions"><span class="annot"><a href="HoYo.Internal.Command.html#MoveOptions"><span class="hs-identifier hs-var">MoveOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MoveOptions"><span class="annot"><a href="HoYo.Internal.Command.html#MoveOptions"><span class="hs-identifier hs-var">MoveOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-46"></span><span>  </span><span id="moveSearch"><span class="annot"><span class="annottext">MoveOptions -&gt; BookmarkSearchTerm
</span><a href="HoYo.Internal.Command.html#moveSearch"><span class="hs-identifier hs-var hs-var">moveSearch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#BookmarkSearchTerm"><span class="hs-identifier hs-type">BookmarkSearchTerm</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093274"><span id="local-6989586621679093276"><span id="local-6989586621679093278"><span class="annot"><span class="annottext">Int -&gt; MoveOptions -&gt; ShowS
[MoveOptions] -&gt; ShowS
MoveOptions -&gt; String
(Int -&gt; MoveOptions -&gt; ShowS)
-&gt; (MoveOptions -&gt; String)
-&gt; ([MoveOptions] -&gt; ShowS)
-&gt; Show MoveOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MoveOptions] -&gt; ShowS
$cshowList :: [MoveOptions] -&gt; ShowS
show :: MoveOptions -&gt; String
$cshow :: MoveOptions -&gt; String
showsPrec :: Int -&gt; MoveOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; MoveOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093270"><span id="local-6989586621679093272"><span class="annot"><span class="annottext">MoveOptions -&gt; MoveOptions -&gt; Bool
(MoveOptions -&gt; MoveOptions -&gt; Bool)
-&gt; (MoveOptions -&gt; MoveOptions -&gt; Bool) -&gt; Eq MoveOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MoveOptions -&gt; MoveOptions -&gt; Bool
$c/= :: MoveOptions -&gt; MoveOptions -&gt; Bool
== :: MoveOptions -&gt; MoveOptions -&gt; Bool
$c== :: MoveOptions -&gt; MoveOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Options for the &quot;list&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-50"></span><span class="hs-keyword">data</span><span> </span><span id="ListOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ListOptions"><span class="hs-identifier hs-var">ListOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ListOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ListOptions"><span class="hs-identifier hs-var">ListOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-51"></span><span>  </span><span id="listFilterName"><span class="annot"><span class="annottext">ListOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#listFilterName"><span class="hs-identifier hs-var hs-var">listFilterName</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="listFilterDirectoryInfix"><span class="annot"><span class="annottext">ListOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#listFilterDirectoryInfix"><span class="hs-identifier hs-var hs-var">listFilterDirectoryInfix</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093261"><span id="local-6989586621679093263"><span id="local-6989586621679093265"><span class="annot"><span class="annottext">Int -&gt; ListOptions -&gt; ShowS
[ListOptions] -&gt; ShowS
ListOptions -&gt; String
(Int -&gt; ListOptions -&gt; ShowS)
-&gt; (ListOptions -&gt; String)
-&gt; ([ListOptions] -&gt; ShowS)
-&gt; Show ListOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ListOptions] -&gt; ShowS
$cshowList :: [ListOptions] -&gt; ShowS
show :: ListOptions -&gt; String
$cshow :: ListOptions -&gt; String
showsPrec :: Int -&gt; ListOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ListOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093257"><span id="local-6989586621679093259"><span class="annot"><span class="annottext">ListOptions -&gt; ListOptions -&gt; Bool
(ListOptions -&gt; ListOptions -&gt; Bool)
-&gt; (ListOptions -&gt; ListOptions -&gt; Bool) -&gt; Eq ListOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ListOptions -&gt; ListOptions -&gt; Bool
$c/= :: ListOptions -&gt; ListOptions -&gt; Bool
== :: ListOptions -&gt; ListOptions -&gt; Bool
$c== :: ListOptions -&gt; ListOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Options for the &quot;clear&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="ClearOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ClearOptions"><span class="hs-identifier hs-var">ClearOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClearOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ClearOptions"><span class="hs-identifier hs-var">ClearOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093250"><span id="local-6989586621679093252"><span id="local-6989586621679093254"><span class="annot"><span class="annottext">Int -&gt; ClearOptions -&gt; ShowS
[ClearOptions] -&gt; ShowS
ClearOptions -&gt; String
(Int -&gt; ClearOptions -&gt; ShowS)
-&gt; (ClearOptions -&gt; String)
-&gt; ([ClearOptions] -&gt; ShowS)
-&gt; Show ClearOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ClearOptions] -&gt; ShowS
$cshowList :: [ClearOptions] -&gt; ShowS
show :: ClearOptions -&gt; String
$cshow :: ClearOptions -&gt; String
showsPrec :: Int -&gt; ClearOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ClearOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093246"><span id="local-6989586621679093248"><span class="annot"><span class="annottext">ClearOptions -&gt; ClearOptions -&gt; Bool
(ClearOptions -&gt; ClearOptions -&gt; Bool)
-&gt; (ClearOptions -&gt; ClearOptions -&gt; Bool) -&gt; Eq ClearOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ClearOptions -&gt; ClearOptions -&gt; Bool
$c/= :: ClearOptions -&gt; ClearOptions -&gt; Bool
== :: ClearOptions -&gt; ClearOptions -&gt; Bool
$c== :: ClearOptions -&gt; ClearOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Options for the &quot;delete&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">newtype</span><span> </span><span id="DeleteOptions"><span class="annot"><a href="HoYo.Internal.Command.html#DeleteOptions"><span class="hs-identifier hs-var">DeleteOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DeleteOptions"><span class="annot"><a href="HoYo.Internal.Command.html#DeleteOptions"><span class="hs-identifier hs-var">DeleteOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-61"></span><span>  </span><span id="deleteSearch"><span class="annot"><span class="annottext">DeleteOptions -&gt; BookmarkSearchTerm
</span><a href="HoYo.Internal.Command.html#deleteSearch"><span class="hs-identifier hs-var hs-var">deleteSearch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#BookmarkSearchTerm"><span class="hs-identifier hs-type">BookmarkSearchTerm</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093238"><span id="local-6989586621679093240"><span id="local-6989586621679093242"><span class="annot"><span class="annottext">Int -&gt; DeleteOptions -&gt; ShowS
[DeleteOptions] -&gt; ShowS
DeleteOptions -&gt; String
(Int -&gt; DeleteOptions -&gt; ShowS)
-&gt; (DeleteOptions -&gt; String)
-&gt; ([DeleteOptions] -&gt; ShowS)
-&gt; Show DeleteOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DeleteOptions] -&gt; ShowS
$cshowList :: [DeleteOptions] -&gt; ShowS
show :: DeleteOptions -&gt; String
$cshow :: DeleteOptions -&gt; String
showsPrec :: Int -&gt; DeleteOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; DeleteOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093234"><span id="local-6989586621679093236"><span class="annot"><span class="annottext">DeleteOptions -&gt; DeleteOptions -&gt; Bool
(DeleteOptions -&gt; DeleteOptions -&gt; Bool)
-&gt; (DeleteOptions -&gt; DeleteOptions -&gt; Bool) -&gt; Eq DeleteOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DeleteOptions -&gt; DeleteOptions -&gt; Bool
$c/= :: DeleteOptions -&gt; DeleteOptions -&gt; Bool
== :: DeleteOptions -&gt; DeleteOptions -&gt; Bool
$c== :: DeleteOptions -&gt; DeleteOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Options for the &quot;refresh&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">data</span><span> </span><span id="RefreshOptions"><span class="annot"><a href="HoYo.Internal.Command.html#RefreshOptions"><span class="hs-identifier hs-var">RefreshOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RefreshOptions"><span class="annot"><a href="HoYo.Internal.Command.html#RefreshOptions"><span class="hs-identifier hs-var">RefreshOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093227"><span id="local-6989586621679093229"><span id="local-6989586621679093231"><span class="annot"><span class="annottext">Int -&gt; RefreshOptions -&gt; ShowS
[RefreshOptions] -&gt; ShowS
RefreshOptions -&gt; String
(Int -&gt; RefreshOptions -&gt; ShowS)
-&gt; (RefreshOptions -&gt; String)
-&gt; ([RefreshOptions] -&gt; ShowS)
-&gt; Show RefreshOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RefreshOptions] -&gt; ShowS
$cshowList :: [RefreshOptions] -&gt; ShowS
show :: RefreshOptions -&gt; String
$cshow :: RefreshOptions -&gt; String
showsPrec :: Int -&gt; RefreshOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; RefreshOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093223"><span id="local-6989586621679093225"><span class="annot"><span class="annottext">RefreshOptions -&gt; RefreshOptions -&gt; Bool
(RefreshOptions -&gt; RefreshOptions -&gt; Bool)
-&gt; (RefreshOptions -&gt; RefreshOptions -&gt; Bool) -&gt; Eq RefreshOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RefreshOptions -&gt; RefreshOptions -&gt; Bool
$c/= :: RefreshOptions -&gt; RefreshOptions -&gt; Bool
== :: RefreshOptions -&gt; RefreshOptions -&gt; Bool
$c== :: RefreshOptions -&gt; RefreshOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Options for the &quot;config print&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-69"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigPrintOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigPrintOptions"><span class="hs-identifier hs-var">ConfigPrintOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConfigPrintOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigPrintOptions"><span class="hs-identifier hs-var">ConfigPrintOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093216"><span id="local-6989586621679093218"><span id="local-6989586621679093220"><span class="annot"><span class="annottext">Int -&gt; ConfigPrintOptions -&gt; ShowS
[ConfigPrintOptions] -&gt; ShowS
ConfigPrintOptions -&gt; String
(Int -&gt; ConfigPrintOptions -&gt; ShowS)
-&gt; (ConfigPrintOptions -&gt; String)
-&gt; ([ConfigPrintOptions] -&gt; ShowS)
-&gt; Show ConfigPrintOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ConfigPrintOptions] -&gt; ShowS
$cshowList :: [ConfigPrintOptions] -&gt; ShowS
show :: ConfigPrintOptions -&gt; String
$cshow :: ConfigPrintOptions -&gt; String
showsPrec :: Int -&gt; ConfigPrintOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ConfigPrintOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093212"><span id="local-6989586621679093214"><span class="annot"><span class="annottext">ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool
(ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool)
-&gt; (ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool)
-&gt; Eq ConfigPrintOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool
$c/= :: ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool
== :: ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool
$c== :: ConfigPrintOptions -&gt; ConfigPrintOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Options for the &quot;config reset&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-73"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigResetOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigResetOptions"><span class="hs-identifier hs-var">ConfigResetOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConfigResetOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigResetOptions"><span class="hs-identifier hs-var">ConfigResetOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093205"><span id="local-6989586621679093207"><span id="local-6989586621679093209"><span class="annot"><span class="annottext">Int -&gt; ConfigResetOptions -&gt; ShowS
[ConfigResetOptions] -&gt; ShowS
ConfigResetOptions -&gt; String
(Int -&gt; ConfigResetOptions -&gt; ShowS)
-&gt; (ConfigResetOptions -&gt; String)
-&gt; ([ConfigResetOptions] -&gt; ShowS)
-&gt; Show ConfigResetOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ConfigResetOptions] -&gt; ShowS
$cshowList :: [ConfigResetOptions] -&gt; ShowS
show :: ConfigResetOptions -&gt; String
$cshow :: ConfigResetOptions -&gt; String
showsPrec :: Int -&gt; ConfigResetOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ConfigResetOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093201"><span id="local-6989586621679093203"><span class="annot"><span class="annottext">ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool
(ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool)
-&gt; (ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool)
-&gt; Eq ConfigResetOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool
$c/= :: ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool
== :: ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool
$c== :: ConfigResetOptions -&gt; ConfigResetOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Options for the &quot;config set&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigSetOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigSetOptions"><span class="hs-identifier hs-var">ConfigSetOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConfigSetOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigSetOptions"><span class="hs-identifier hs-var">ConfigSetOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-78"></span><span>  </span><span id="setKey"><span class="annot"><span class="annottext">ConfigSetOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#setKey"><span class="hs-identifier hs-var hs-var">setKey</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="setValue"><span class="annot"><span class="annottext">ConfigSetOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#setValue"><span class="hs-identifier hs-var hs-var">setValue</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093192"><span id="local-6989586621679093194"><span id="local-6989586621679093196"><span class="annot"><span class="annottext">Int -&gt; ConfigSetOptions -&gt; ShowS
[ConfigSetOptions] -&gt; ShowS
ConfigSetOptions -&gt; String
(Int -&gt; ConfigSetOptions -&gt; ShowS)
-&gt; (ConfigSetOptions -&gt; String)
-&gt; ([ConfigSetOptions] -&gt; ShowS)
-&gt; Show ConfigSetOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ConfigSetOptions] -&gt; ShowS
$cshowList :: [ConfigSetOptions] -&gt; ShowS
show :: ConfigSetOptions -&gt; String
$cshow :: ConfigSetOptions -&gt; String
showsPrec :: Int -&gt; ConfigSetOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ConfigSetOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093188"><span id="local-6989586621679093190"><span class="annot"><span class="annottext">ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool
(ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool)
-&gt; (ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool)
-&gt; Eq ConfigSetOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool
$c/= :: ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool
== :: ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool
$c== :: ConfigSetOptions -&gt; ConfigSetOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Options for the &quot;config add-default&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-83"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigAddDefaultOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigAddDefaultOptions"><span class="hs-identifier hs-var">ConfigAddDefaultOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ConfigAddDefaultOptions"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigAddDefaultOptions"><span class="hs-identifier hs-var">ConfigAddDefaultOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-84"></span><span>  </span><span id="addDefaultDir"><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#addDefaultDir"><span class="hs-identifier hs-var hs-var">addDefaultDir</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="addDefaultName"><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#addDefaultName"><span class="hs-identifier hs-var hs-var">addDefaultName</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093179"><span id="local-6989586621679093181"><span id="local-6989586621679093183"><span class="annot"><span class="annottext">Int -&gt; ConfigAddDefaultOptions -&gt; ShowS
[ConfigAddDefaultOptions] -&gt; ShowS
ConfigAddDefaultOptions -&gt; String
(Int -&gt; ConfigAddDefaultOptions -&gt; ShowS)
-&gt; (ConfigAddDefaultOptions -&gt; String)
-&gt; ([ConfigAddDefaultOptions] -&gt; ShowS)
-&gt; Show ConfigAddDefaultOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ConfigAddDefaultOptions] -&gt; ShowS
$cshowList :: [ConfigAddDefaultOptions] -&gt; ShowS
show :: ConfigAddDefaultOptions -&gt; String
$cshow :: ConfigAddDefaultOptions -&gt; String
showsPrec :: Int -&gt; ConfigAddDefaultOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; ConfigAddDefaultOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093175"><span id="local-6989586621679093177"><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool
(ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool)
-&gt; (ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool)
-&gt; Eq ConfigAddDefaultOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool
$c/= :: ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool
== :: ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool
$c== :: ConfigAddDefaultOptions -&gt; ConfigAddDefaultOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Options for the &quot;config&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span> </span><span id="ConfigCommand"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigCommand"><span class="hs-identifier hs-var">ConfigCommand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>  </span><span id="Print"><span class="annot"><a href="HoYo.Internal.Command.html#Print"><span class="hs-identifier hs-var">Print</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigPrintOptions"><span class="hs-identifier hs-type">ConfigPrintOptions</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Reset"><span class="annot"><a href="HoYo.Internal.Command.html#Reset"><span class="hs-identifier hs-var">Reset</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigResetOptions"><span class="hs-identifier hs-type">ConfigResetOptions</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Set"><span class="annot"><a href="HoYo.Internal.Command.html#Set"><span class="hs-identifier hs-var">Set</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigSetOptions"><span class="hs-identifier hs-type">ConfigSetOptions</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AddDefaultBookmark"><span class="annot"><a href="HoYo.Internal.Command.html#AddDefaultBookmark"><span class="hs-identifier hs-var">AddDefaultBookmark</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigAddDefaultOptions"><span class="hs-identifier hs-type">ConfigAddDefaultOptions</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093165"><span id="local-6989586621679093167"><span id="local-6989586621679093169"><span class="annot"><span class="annottext">Int -&gt; ConfigCommand -&gt; ShowS
[ConfigCommand] -&gt; ShowS
ConfigCommand -&gt; String
(Int -&gt; ConfigCommand -&gt; ShowS)
-&gt; (ConfigCommand -&gt; String)
-&gt; ([ConfigCommand] -&gt; ShowS)
-&gt; Show ConfigCommand
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ConfigCommand] -&gt; ShowS
$cshowList :: [ConfigCommand] -&gt; ShowS
show :: ConfigCommand -&gt; String
$cshow :: ConfigCommand -&gt; String
showsPrec :: Int -&gt; ConfigCommand -&gt; ShowS
$cshowsPrec :: Int -&gt; ConfigCommand -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093161"><span id="local-6989586621679093163"><span class="annot"><span class="annottext">ConfigCommand -&gt; ConfigCommand -&gt; Bool
(ConfigCommand -&gt; ConfigCommand -&gt; Bool)
-&gt; (ConfigCommand -&gt; ConfigCommand -&gt; Bool) -&gt; Eq ConfigCommand
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ConfigCommand -&gt; ConfigCommand -&gt; Bool
$c/= :: ConfigCommand -&gt; ConfigCommand -&gt; Bool
== :: ConfigCommand -&gt; ConfigCommand -&gt; Bool
$c== :: ConfigCommand -&gt; ConfigCommand -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Options for the &quot;check&quot; command to be parsed from the command-line.</span><span>
</span><span id="line-97"></span><span class="hs-keyword">data</span><span> </span><span id="CheckOptions"><span class="annot"><a href="HoYo.Internal.Command.html#CheckOptions"><span class="hs-identifier hs-var">CheckOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CheckOptions"><span class="annot"><a href="HoYo.Internal.Command.html#CheckOptions"><span class="hs-identifier hs-var">CheckOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-98"></span><span>  </span><span id="checkConfig"><span class="annot"><span class="annottext">CheckOptions -&gt; Bool
</span><a href="HoYo.Internal.Command.html#checkConfig"><span class="hs-identifier hs-var hs-var">checkConfig</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="checkBookmarks"><span class="annot"><span class="annottext">CheckOptions -&gt; Bool
</span><a href="HoYo.Internal.Command.html#checkBookmarks"><span class="hs-identifier hs-var hs-var">checkBookmarks</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093152"><span id="local-6989586621679093154"><span id="local-6989586621679093156"><span class="annot"><span class="annottext">Int -&gt; CheckOptions -&gt; ShowS
[CheckOptions] -&gt; ShowS
CheckOptions -&gt; String
(Int -&gt; CheckOptions -&gt; ShowS)
-&gt; (CheckOptions -&gt; String)
-&gt; ([CheckOptions] -&gt; ShowS)
-&gt; Show CheckOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CheckOptions] -&gt; ShowS
$cshowList :: [CheckOptions] -&gt; ShowS
show :: CheckOptions -&gt; String
$cshow :: CheckOptions -&gt; String
showsPrec :: Int -&gt; CheckOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; CheckOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093148"><span id="local-6989586621679093150"><span class="annot"><span class="annottext">CheckOptions -&gt; CheckOptions -&gt; Bool
(CheckOptions -&gt; CheckOptions -&gt; Bool)
-&gt; (CheckOptions -&gt; CheckOptions -&gt; Bool) -&gt; Eq CheckOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CheckOptions -&gt; CheckOptions -&gt; Bool
$c/= :: CheckOptions -&gt; CheckOptions -&gt; Bool
== :: CheckOptions -&gt; CheckOptions -&gt; Bool
$c== :: CheckOptions -&gt; CheckOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | The core data-type for the hoyo CLI. The 'Command' is parsed from the command-line,</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- then 'runCommand' dispatches on the type.</span><span>
</span><span id="line-104"></span><span class="hs-keyword">data</span><span> </span><span id="Command"><span class="annot"><a href="HoYo.Internal.Command.html#Command"><span class="hs-identifier hs-var">Command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span id="Add"><span class="annot"><a href="HoYo.Internal.Command.html#Add"><span class="hs-identifier hs-var">Add</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#AddOptions"><span class="hs-identifier hs-type">AddOptions</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Move"><span class="annot"><a href="HoYo.Internal.Command.html#Move"><span class="hs-identifier hs-var">Move</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MoveOptions"><span class="hs-identifier hs-type">MoveOptions</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="List"><span class="annot"><a href="HoYo.Internal.Command.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ListOptions"><span class="hs-identifier hs-type">ListOptions</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Clear"><span class="annot"><a href="HoYo.Internal.Command.html#Clear"><span class="hs-identifier hs-var">Clear</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ClearOptions"><span class="hs-identifier hs-type">ClearOptions</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Delete"><span class="annot"><a href="HoYo.Internal.Command.html#Delete"><span class="hs-identifier hs-var">Delete</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#DeleteOptions"><span class="hs-identifier hs-type">DeleteOptions</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Refresh"><span class="annot"><a href="HoYo.Internal.Command.html#Refresh"><span class="hs-identifier hs-var">Refresh</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#RefreshOptions"><span class="hs-identifier hs-type">RefreshOptions</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ConfigCmd"><span class="annot"><a href="HoYo.Internal.Command.html#ConfigCmd"><span class="hs-identifier hs-var">ConfigCmd</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigCommand"><span class="hs-identifier hs-type">ConfigCommand</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Check"><span class="annot"><a href="HoYo.Internal.Command.html#Check"><span class="hs-identifier hs-var">Check</span></a></span></span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#CheckOptions"><span class="hs-identifier hs-type">CheckOptions</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DefaultCommand"><span class="annot"><a href="HoYo.Internal.Command.html#DefaultCommand"><span class="hs-identifier hs-var">DefaultCommand</span></a></span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093133"><span id="local-6989586621679093135"><span id="local-6989586621679093137"><span class="annot"><span class="annottext">Int -&gt; Command -&gt; ShowS
[Command] -&gt; ShowS
Command -&gt; String
(Int -&gt; Command -&gt; ShowS)
-&gt; (Command -&gt; String) -&gt; ([Command] -&gt; ShowS) -&gt; Show Command
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Command] -&gt; ShowS
$cshowList :: [Command] -&gt; ShowS
show :: Command -&gt; String
$cshow :: Command -&gt; String
showsPrec :: Int -&gt; Command -&gt; ShowS
$cshowsPrec :: Int -&gt; Command -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093129"><span id="local-6989586621679093131"><span class="annot"><span class="annottext">Command -&gt; Command -&gt; Bool
(Command -&gt; Command -&gt; Bool)
-&gt; (Command -&gt; Command -&gt; Bool) -&gt; Eq Command
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Command -&gt; Command -&gt; Bool
$c/= :: Command -&gt; Command -&gt; Bool
== :: Command -&gt; Command -&gt; Bool
$c== :: Command -&gt; Command -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Datatype for representing a command-line settings override.</span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="MaybeOverride"><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-var">MaybeOverride</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-118"></span><span>  </span><span id="OverrideFalse"><span class="annot"><a href="HoYo.Internal.Command.html#OverrideFalse"><span class="hs-identifier hs-var">OverrideFalse</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OverrideTrue"><span class="annot"><a href="HoYo.Internal.Command.html#OverrideTrue"><span class="hs-identifier hs-var">OverrideTrue</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoOverride"><span class="annot"><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Conflict"><span class="annot"><a href="HoYo.Internal.Command.html#Conflict"><span class="hs-identifier hs-var">Conflict</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093119"><span id="local-6989586621679093121"><span id="local-6989586621679093123"><span class="annot"><span class="annottext">Int -&gt; MaybeOverride -&gt; ShowS
[MaybeOverride] -&gt; ShowS
MaybeOverride -&gt; String
(Int -&gt; MaybeOverride -&gt; ShowS)
-&gt; (MaybeOverride -&gt; String)
-&gt; ([MaybeOverride] -&gt; ShowS)
-&gt; Show MaybeOverride
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MaybeOverride] -&gt; ShowS
$cshowList :: [MaybeOverride] -&gt; ShowS
show :: MaybeOverride -&gt; String
$cshow :: MaybeOverride -&gt; String
showsPrec :: Int -&gt; MaybeOverride -&gt; ShowS
$cshowsPrec :: Int -&gt; MaybeOverride -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093115"><span id="local-6989586621679093117"><span class="annot"><span class="annottext">MaybeOverride -&gt; MaybeOverride -&gt; Bool
(MaybeOverride -&gt; MaybeOverride -&gt; Bool)
-&gt; (MaybeOverride -&gt; MaybeOverride -&gt; Bool) -&gt; Eq MaybeOverride
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MaybeOverride -&gt; MaybeOverride -&gt; Bool
$c/= :: MaybeOverride -&gt; MaybeOverride -&gt; Bool
== :: MaybeOverride -&gt; MaybeOverride -&gt; Bool
$c== :: MaybeOverride -&gt; MaybeOverride -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Combine a config flag with a command-line flag, checking for conflicts.</span><span>
</span><span id="line-125"></span><span class="annot"><a href="HoYo.Internal.Command.html#combOverride"><span class="hs-identifier hs-type">combOverride</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span>
</span><span id="line-126"></span><span id="combOverride"><span class="annot"><span class="annottext">combOverride :: Bool -&gt; Bool -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#combOverride"><span class="hs-identifier hs-var hs-var">combOverride</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span>
</span><span id="line-127"></span><span class="annot"><a href="HoYo.Internal.Command.html#combOverride"><span class="hs-identifier hs-var">combOverride</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#OverrideTrue"><span class="hs-identifier hs-var">OverrideTrue</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="HoYo.Internal.Command.html#combOverride"><span class="hs-identifier hs-var">combOverride</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#OverrideFalse"><span class="hs-identifier hs-var">OverrideFalse</span></a></span><span>
</span><span id="line-129"></span><span class="annot"><a href="HoYo.Internal.Command.html#combOverride"><span class="hs-identifier hs-var">combOverride</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#Conflict"><span class="hs-identifier hs-var">Conflict</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Config settings that can be overriden using command-line flags.</span><span>
</span><span id="line-132"></span><span class="hs-keyword">data</span><span> </span><span id="OverrideOptions"><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-var">OverrideOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OverrideOptions"><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-var">OverrideOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-133"></span><span>  </span><span id="overrideFailOnError"><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideFailOnError"><span class="hs-identifier hs-var hs-var">overrideFailOnError</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="overrideDisplayCreationTime"><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideDisplayCreationTime"><span class="hs-identifier hs-var hs-var">overrideDisplayCreationTime</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="overrideEnableClearing"><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideEnableClearing"><span class="hs-identifier hs-var hs-var">overrideEnableClearing</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="overrideEnableReset"><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideEnableReset"><span class="hs-identifier hs-var hs-var">overrideEnableReset</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093103"><span id="local-6989586621679093105"><span id="local-6989586621679093107"><span class="annot"><span class="annottext">Int -&gt; OverrideOptions -&gt; ShowS
[OverrideOptions] -&gt; ShowS
OverrideOptions -&gt; String
(Int -&gt; OverrideOptions -&gt; ShowS)
-&gt; (OverrideOptions -&gt; String)
-&gt; ([OverrideOptions] -&gt; ShowS)
-&gt; Show OverrideOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OverrideOptions] -&gt; ShowS
$cshowList :: [OverrideOptions] -&gt; ShowS
show :: OverrideOptions -&gt; String
$cshow :: OverrideOptions -&gt; String
showsPrec :: Int -&gt; OverrideOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; OverrideOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093099"><span id="local-6989586621679093101"><span class="annot"><span class="annottext">OverrideOptions -&gt; OverrideOptions -&gt; Bool
(OverrideOptions -&gt; OverrideOptions -&gt; Bool)
-&gt; (OverrideOptions -&gt; OverrideOptions -&gt; Bool)
-&gt; Eq OverrideOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OverrideOptions -&gt; OverrideOptions -&gt; Bool
$c/= :: OverrideOptions -&gt; OverrideOptions -&gt; Bool
== :: OverrideOptions -&gt; OverrideOptions -&gt; Bool
$c== :: OverrideOptions -&gt; OverrideOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Convert a 'MaybeOverride' to a function on 'Bool'.</span><span>
</span><span id="line-140"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-type">overrideFunc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MaybeOverride"><span class="hs-identifier hs-type">MaybeOverride</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span id="overrideFunc"><span class="annot"><span class="annottext">overrideFunc :: MaybeOverride -&gt; Bool -&gt; Bool
</span><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var hs-var">overrideFunc</span></a></span></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-142"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#OverrideTrue"><span class="hs-identifier hs-var">OverrideTrue</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-143"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#OverrideFalse"><span class="hs-identifier hs-var">OverrideFalse</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#Conflict"><span class="hs-identifier hs-var">Conflict</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Bool
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;override conflict!&quot;</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Apply the override options to a 'Config'.</span><span>
</span><span id="line-147"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideConfig"><span class="hs-identifier hs-type">overrideConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-148"></span><span id="overrideConfig"><span class="annot"><span class="annottext">overrideConfig :: OverrideOptions -&gt; Config -&gt; Config
</span><a href="HoYo.Internal.Command.html#overrideConfig"><span class="hs-identifier hs-var hs-var">overrideConfig</span></a></span></span><span> </span><span id="local-6989586621679093093"><span class="annot"><span class="annottext">OverrideOptions
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
-&gt; (Bool -&gt; Bool) -&gt; Config -&gt; Config
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#failOnError"><span class="hs-identifier hs-var">failOnError</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeOverride -&gt; Bool -&gt; Bool
</span><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeOverride -&gt; Bool -&gt; Bool) -&gt; MaybeOverride -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>         </span><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideFailOnError"><span class="hs-identifier hs-var hs-var">overrideFailOnError</span></a></span><span> </span><span class="annot"><span class="annottext">OverrideOptions
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">(Config -&gt; Config) -&gt; (Config -&gt; Config) -&gt; Config -&gt; Config
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
-&gt; (Bool -&gt; Bool) -&gt; Config -&gt; Config
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#displayCreationTime"><span class="hs-identifier hs-var">displayCreationTime</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeOverride -&gt; Bool -&gt; Bool
</span><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeOverride -&gt; Bool -&gt; Bool) -&gt; MaybeOverride -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideDisplayCreationTime"><span class="hs-identifier hs-var hs-var">overrideDisplayCreationTime</span></a></span><span> </span><span class="annot"><span class="annottext">OverrideOptions
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">(Config -&gt; Config) -&gt; (Config -&gt; Config) -&gt; Config -&gt; Config
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
-&gt; (Bool -&gt; Bool) -&gt; Config -&gt; Config
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#enableClearing"><span class="hs-identifier hs-var">enableClearing</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeOverride -&gt; Bool -&gt; Bool
</span><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeOverride -&gt; Bool -&gt; Bool) -&gt; MaybeOverride -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>      </span><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideEnableClearing"><span class="hs-identifier hs-var hs-var">overrideEnableClearing</span></a></span><span> </span><span class="annot"><span class="annottext">OverrideOptions
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="annottext">(Config -&gt; Config) -&gt; (Config -&gt; Config) -&gt; Config -&gt; Config
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
-&gt; (Bool -&gt; Bool) -&gt; Config -&gt; Config
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config Bool Bool
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#enableReset"><span class="hs-identifier hs-var">enableReset</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeOverride -&gt; Bool -&gt; Bool
</span><a href="HoYo.Internal.Command.html#overrideFunc"><span class="hs-identifier hs-var">overrideFunc</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeOverride -&gt; Bool -&gt; Bool) -&gt; MaybeOverride -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>         </span><span class="annot"><span class="annottext">OverrideOptions -&gt; MaybeOverride
</span><a href="HoYo.Internal.Command.html#overrideEnableReset"><span class="hs-identifier hs-var hs-var">overrideEnableReset</span></a></span><span> </span><span class="annot"><span class="annottext">OverrideOptions
</span><a href="#local-6989586621679093093"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Apply the override options to an 'Env'.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="HoYo.Internal.Command.html#overrideEnv"><span class="hs-identifier hs-type">overrideEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-156"></span><span id="overrideEnv"><span class="annot"><span class="annottext">overrideEnv :: OverrideOptions -&gt; Env -&gt; Env
</span><a href="HoYo.Internal.Command.html#overrideEnv"><span class="hs-identifier hs-var hs-var">overrideEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ASetter Env Env Config Config -&gt; (Config -&gt; Config) -&gt; Env -&gt; Env
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Env Env Config Config
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Config) -&gt; Env -&gt; Env)
-&gt; (OverrideOptions -&gt; Config -&gt; Config)
-&gt; OverrideOptions
-&gt; Env
-&gt; Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OverrideOptions -&gt; Config -&gt; Config
</span><a href="HoYo.Internal.Command.html#overrideConfig"><span class="hs-identifier hs-var">overrideConfig</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | Check that there are no conflicting overrides.</span><span>
</span><span id="line-159"></span><span class="annot"><a href="HoYo.Internal.Command.html#verifyOverrides"><span class="hs-identifier hs-type">verifyOverrides</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-160"></span><span id="verifyOverrides"><span class="annot"><span class="annottext">verifyOverrides :: OverrideOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#verifyOverrides"><span class="hs-identifier hs-var hs-var">verifyOverrides</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span> </span><span id="local-6989586621679093083"><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093083"><span class="hs-identifier hs-var">o1</span></a></span></span><span> </span><span id="local-6989586621679093082"><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">o2</span></a></span></span><span> </span><span id="local-6989586621679093081"><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093081"><span class="hs-identifier hs-var">o3</span></a></span></span><span> </span><span id="local-6989586621679093080"><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">o4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride -&gt; Maybe TFilePath
forall a. IsString a =&gt; MaybeOverride -&gt; Maybe a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093083"><span class="hs-identifier hs-var">o1</span></a></span><span>
</span><span id="line-161"></span><span>                                                  </span><span class="annot"><span class="annottext">Maybe TFilePath -&gt; Maybe TFilePath -&gt; Maybe TFilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">MaybeOverride -&gt; Maybe TFilePath
forall a. IsString a =&gt; MaybeOverride -&gt; Maybe a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">o2</span></a></span><span>
</span><span id="line-162"></span><span>                                                  </span><span class="annot"><span class="annottext">Maybe TFilePath -&gt; Maybe TFilePath -&gt; Maybe TFilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">MaybeOverride -&gt; Maybe TFilePath
forall a. IsString a =&gt; MaybeOverride -&gt; Maybe a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093081"><span class="hs-identifier hs-var">o3</span></a></span><span>
</span><span id="line-163"></span><span>                                                  </span><span class="annot"><span class="annottext">Maybe TFilePath -&gt; Maybe TFilePath -&gt; Maybe TFilePath
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">MaybeOverride -&gt; Maybe TFilePath
forall a. IsString a =&gt; MaybeOverride -&gt; Maybe a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">o4</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679093079"><span class="annot"><span class="annottext">verify :: MaybeOverride -&gt; Maybe a
</span><a href="#local-6989586621679093079"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#Conflict"><span class="hs-identifier hs-var">Conflict</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;conflicting flags&quot;</span></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><a href="#local-6989586621679093079"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | CLI options that can be set regardless of which command is run.</span><span>
</span><span id="line-168"></span><span class="hs-keyword">data</span><span> </span><span id="GlobalOptions"><span class="annot"><a href="HoYo.Internal.Command.html#GlobalOptions"><span class="hs-identifier hs-var">GlobalOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GlobalOptions"><span class="annot"><a href="HoYo.Internal.Command.html#GlobalOptions"><span class="hs-identifier hs-var">GlobalOptions</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-169"></span><span>  </span><span id="globalConfigPath"><span class="annot"><span class="annottext">GlobalOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#globalConfigPath"><span class="hs-identifier hs-var hs-var">globalConfigPath</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dataPath"><span class="annot"><span class="annottext">GlobalOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#dataPath"><span class="hs-identifier hs-var hs-var">dataPath</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="overrides"><span class="annot"><span class="annottext">GlobalOptions -&gt; OverrideOptions
</span><a href="HoYo.Internal.Command.html#overrides"><span class="hs-identifier hs-var hs-var">overrides</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093068"><span id="local-6989586621679093070"><span id="local-6989586621679093072"><span class="annot"><span class="annottext">Int -&gt; GlobalOptions -&gt; ShowS
[GlobalOptions] -&gt; ShowS
GlobalOptions -&gt; String
(Int -&gt; GlobalOptions -&gt; ShowS)
-&gt; (GlobalOptions -&gt; String)
-&gt; ([GlobalOptions] -&gt; ShowS)
-&gt; Show GlobalOptions
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GlobalOptions] -&gt; ShowS
$cshowList :: [GlobalOptions] -&gt; ShowS
show :: GlobalOptions -&gt; String
$cshow :: GlobalOptions -&gt; String
showsPrec :: Int -&gt; GlobalOptions -&gt; ShowS
$cshowsPrec :: Int -&gt; GlobalOptions -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093064"><span id="local-6989586621679093066"><span class="annot"><span class="annottext">GlobalOptions -&gt; GlobalOptions -&gt; Bool
(GlobalOptions -&gt; GlobalOptions -&gt; Bool)
-&gt; (GlobalOptions -&gt; GlobalOptions -&gt; Bool) -&gt; Eq GlobalOptions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GlobalOptions -&gt; GlobalOptions -&gt; Bool
$c/= :: GlobalOptions -&gt; GlobalOptions -&gt; Bool
== :: GlobalOptions -&gt; GlobalOptions -&gt; Bool
$c== :: GlobalOptions -&gt; GlobalOptions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | The default behaviour is to override nothing.</span><span>
</span><span id="line-175"></span><span class="annot"><a href="HoYo.Internal.Command.html#defaultOverrideOptions"><span class="hs-identifier hs-type">defaultOverrideOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-type">OverrideOptions</span></a></span><span>
</span><span id="line-176"></span><span id="defaultOverrideOptions"><span class="annot"><span class="annottext">defaultOverrideOptions :: OverrideOptions
</span><a href="HoYo.Internal.Command.html#defaultOverrideOptions"><span class="hs-identifier hs-var hs-var">defaultOverrideOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeOverride
-&gt; MaybeOverride
-&gt; MaybeOverride
-&gt; MaybeOverride
-&gt; OverrideOptions
</span><a href="HoYo.Internal.Command.html#OverrideOptions"><span class="hs-identifier hs-var">OverrideOptions</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeOverride
</span><a href="HoYo.Internal.Command.html#NoOverride"><span class="hs-identifier hs-var">NoOverride</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Default global options. In general this should do nothing.</span><span>
</span><span id="line-179"></span><span class="annot"><a href="HoYo.Internal.Command.html#defaultGlobalOptions"><span class="hs-identifier hs-type">defaultGlobalOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#GlobalOptions"><span class="hs-identifier hs-type">GlobalOptions</span></a></span><span>
</span><span id="line-180"></span><span id="defaultGlobalOptions"><span class="annot"><span class="annottext">defaultGlobalOptions :: GlobalOptions
</span><a href="HoYo.Internal.Command.html#defaultGlobalOptions"><span class="hs-identifier hs-var hs-var">defaultGlobalOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath
-&gt; Maybe TFilePath -&gt; OverrideOptions -&gt; GlobalOptions
</span><a href="HoYo.Internal.Command.html#GlobalOptions"><span class="hs-identifier hs-var">GlobalOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">OverrideOptions
</span><a href="HoYo.Internal.Command.html#defaultOverrideOptions"><span class="hs-identifier hs-var">defaultOverrideOptions</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | The final result of parsing the CLI arguments. Contains a command and all</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- information for that command, and any global options that have been set.</span><span>
</span><span id="line-184"></span><span class="hs-keyword">data</span><span> </span><span id="Options"><span class="annot"><a href="HoYo.Internal.Command.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Options"><span class="annot"><a href="HoYo.Internal.Command.html#Options"><span class="hs-identifier hs-var">Options</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-185"></span><span>  </span><span id="optCommand"><span class="annot"><span class="annottext">Options -&gt; Command
</span><a href="HoYo.Internal.Command.html#optCommand"><span class="hs-identifier hs-var hs-var">optCommand</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGlobals"><span class="annot"><span class="annottext">Options -&gt; GlobalOptions
</span><a href="HoYo.Internal.Command.html#optGlobals"><span class="hs-identifier hs-var hs-var">optGlobals</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#GlobalOptions"><span class="hs-identifier hs-type">GlobalOptions</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093053"><span id="local-6989586621679093055"><span id="local-6989586621679093057"><span class="annot"><span class="annottext">Int -&gt; Options -&gt; ShowS
[Options] -&gt; ShowS
Options -&gt; String
(Int -&gt; Options -&gt; ShowS)
-&gt; (Options -&gt; String) -&gt; ([Options] -&gt; ShowS) -&gt; Show Options
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Options] -&gt; ShowS
$cshowList :: [Options] -&gt; ShowS
show :: Options -&gt; String
$cshow :: Options -&gt; String
showsPrec :: Int -&gt; Options -&gt; ShowS
$cshowsPrec :: Int -&gt; Options -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093049"><span id="local-6989586621679093051"><span class="annot"><span class="annottext">Options -&gt; Options -&gt; Bool
(Options -&gt; Options -&gt; Bool)
-&gt; (Options -&gt; Options -&gt; Bool) -&gt; Eq Options
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Options -&gt; Options -&gt; Bool
$c/= :: Options -&gt; Options -&gt; Bool
== :: Options -&gt; Options -&gt; Bool
$c== :: Options -&gt; Options -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Helper function whenever we need to modify the saved bookmarks.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- @modifyBookmarks f@ retrieves the current bookmarks, applies @f@,</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- and saves them back to file.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="HoYo.Internal.Command.html#modifyBookmarks"><span class="hs-identifier hs-type">modifyBookmarks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-type">Bookmark</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-type">Bookmark</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="modifyBookmarks"><span class="annot"><span class="annottext">modifyBookmarks :: ([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarks"><span class="hs-identifier hs-var hs-var">modifyBookmarks</span></a></span></span><span> </span><span id="local-6989586621679093047"><span class="annot"><span class="annottext">[Bookmark] -&gt; [Bookmark]
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarksM"><span class="hs-identifier hs-var">modifyBookmarksM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; HoYoMonad [Bookmark])
-&gt; ([Bookmark] -&gt; [Bookmark]) -&gt; [Bookmark] -&gt; HoYoMonad [Bookmark]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; [Bookmark]
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Helper function twhenever we need to modify the saved bookmarks,</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- and need access to the hoyo environment.</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- @modifyBookmarks f@ retrieves the current bookmarks, applies @f@</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- in the hoyo environment, and saves them back to file.</span><span>
</span><span id="line-201"></span><span class="annot"><a href="HoYo.Internal.Command.html#modifyBookmarksM"><span class="hs-identifier hs-type">modifyBookmarksM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-type">Bookmark</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-type">Bookmark</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="modifyBookmarksM"><span class="annot"><span class="annottext">modifyBookmarksM :: ([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarksM"><span class="hs-identifier hs-var hs-var">modifyBookmarksM</span></a></span></span><span> </span><span id="local-6989586621679093045"><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
</span><a href="#local-6989586621679093045"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="HoYo.Internal.Types.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmarks"><span class="hs-identifier hs-type">Bookmarks</span></a></span><span> </span><span id="local-6989586621679093042"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093042"><span class="hs-identifier hs-var">bms</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679093041"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093041"><span class="hs-identifier hs-var">bFp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HoYoMonad Env
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679093040"><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679093040"><span class="hs-identifier hs-var">newBookmarks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; Bookmarks
</span><a href="HoYo.Internal.Types.html#Bookmarks"><span class="hs-identifier hs-var">Bookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; Bookmarks)
-&gt; HoYoMonad [Bookmark] -&gt; HoYoMonad Bookmarks
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
</span><a href="#local-6989586621679093045"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093042"><span class="hs-identifier hs-var">bms</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; Bookmarks -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; Bookmarks -&gt; m ()
</span><a href="HoYo.Internal.Bookmark.html#encodeBookmarksFile"><span class="hs-identifier hs-var">encodeBookmarksFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093041"><span class="hs-identifier hs-var">bFp</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679093040"><span class="hs-identifier hs-var">newBookmarks</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Normalise a filepath and make sure it's a valid directory.</span><span>
</span><span id="line-208"></span><span class="annot"><a href="HoYo.Internal.Command.html#normaliseAndVerifyDirectory"><span class="hs-identifier hs-type">normaliseAndVerifyDirectory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span>
</span><span id="line-209"></span><span id="normaliseAndVerifyDirectory"><span class="annot"><span class="annottext">normaliseAndVerifyDirectory :: TFilePath -&gt; HoYoMonad TFilePath
</span><a href="HoYo.Internal.Command.html#normaliseAndVerifyDirectory"><span class="hs-identifier hs-var hs-var">normaliseAndVerifyDirectory</span></a></span></span><span> </span><span id="local-6989586621679093036"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093036"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679093035"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679093035"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; HoYoMonad String
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO String -&gt; HoYoMonad String) -&gt; IO String -&gt; HoYoMonad String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">canonicalizePath</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093036"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Utils.html#assertVerbose"><span class="hs-identifier hs-var">assertVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;not a directory&quot;</span></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad Bool)
-&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; HoYoMonad Bool) -&gt; IO Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesDirectoryExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679093035"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad TFilePath
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; HoYoMonad TFilePath)
-&gt; TFilePath -&gt; HoYoMonad TFilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TFilePath
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679093035"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Take a name and make sure it's valid.</span><span>
</span><span id="line-215"></span><span class="annot"><a href="HoYo.Internal.Command.html#verifyName"><span class="hs-identifier hs-type">verifyName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span id="verifyName"><span class="annot"><span class="annottext">verifyName :: TFilePath -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#verifyName"><span class="hs-identifier hs-var hs-var">verifyName</span></a></span></span><span> </span><span id="local-6989586621679093027"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093027"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093026"><span class="annot"><span class="annottext">nameStr :: String
</span><a href="#local-6989586621679093026"><span class="hs-identifier hs-var hs-var">nameStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; String
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093027"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Utils.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;bookmark name can't be empty&quot;</span></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad ()) -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HoYoMonad Bool) -&gt; Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093027"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Utils.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;bookmark name can't be a number&quot;</span></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad ()) -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HoYoMonad Bool) -&gt; Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679093026"><span class="hs-identifier hs-var">nameStr</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Given the existing bookmarks and a potential bookmark name,</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- test if the new bookmark will have a unique name.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="HoYo.Internal.Command.html#testNameUnique"><span class="hs-identifier hs-type">testNameUnique</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-type">Bookmark</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-224"></span><span id="testNameUnique"><span class="annot"><span class="annottext">testNameUnique :: [Bookmark] -&gt; TFilePath -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Command.html#testNameUnique"><span class="hs-identifier hs-var hs-var">testNameUnique</span></a></span></span><span> </span><span id="local-6989586621679093020"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093020"><span class="hs-identifier hs-var">bms</span></a></span></span><span> </span><span id="local-6989586621679093019"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093019"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Utils.html#assertVerbose"><span class="hs-identifier hs-var">assertVerbose</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;bookmark name already used&quot;</span></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad Bool)
-&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HoYoMonad Bool) -&gt; Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Bool) -&gt; [Bookmark] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe TFilePath -&gt; Maybe TFilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Maybe TFilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093019"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe TFilePath -&gt; Bool)
-&gt; (Bookmark -&gt; Maybe TFilePath) -&gt; Bookmark -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe TFilePath) Bookmark (Maybe TFilePath)
-&gt; Bookmark -&gt; Maybe TFilePath
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (Maybe TFilePath) Bookmark (Maybe TFilePath)
Lens' Bookmark (Maybe TFilePath)
</span><a href="HoYo.Internal.Types.html#bookmarkName"><span class="hs-identifier hs-var">bookmarkName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093020"><span class="hs-identifier hs-var">bms</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Run the &quot;add&quot; command: add a new bookmark.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="HoYo.Internal.Command.html#runAdd"><span class="hs-identifier hs-type">runAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#AddOptions"><span class="hs-identifier hs-type">AddOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span id="runAdd"><span class="annot"><span class="annottext">runAdd :: AddOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runAdd"><span class="hs-identifier hs-var hs-var">runAdd</span></a></span></span><span> </span><span id="local-6989586621679093014"><span class="annot"><span class="annottext">AddOptions
</span><a href="#local-6989586621679093014"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679093013"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad TFilePath
</span><a href="HoYo.Internal.Command.html#normaliseAndVerifyDirectory"><span class="hs-identifier hs-var">normaliseAndVerifyDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; HoYoMonad TFilePath)
-&gt; TFilePath -&gt; HoYoMonad TFilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AddOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#addDirectory"><span class="hs-identifier hs-var hs-var">addDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">AddOptions
</span><a href="#local-6989586621679093014"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093012"><span class="annot"><span class="annottext">name :: Maybe TFilePath
</span><a href="#local-6989586621679093012"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#addName"><span class="hs-identifier hs-var hs-var">addName</span></a></span><span> </span><span class="annot"><span class="annottext">AddOptions
</span><a href="#local-6989586621679093014"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarksM"><span class="hs-identifier hs-var">modifyBookmarksM</span></a></span><span> </span><span class="annot"><span class="annottext">(([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ())
-&gt; ([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679093011"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093011"><span class="hs-identifier hs-var">bms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621679093010"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679093010"><span class="hs-identifier hs-var">uniqName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; TFilePath -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Command.html#testNameUnique"><span class="hs-identifier hs-var">testNameUnique</span></a></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093011"><span class="hs-identifier hs-var">bms</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679093010"><span class="hs-identifier hs-var">uniqName</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093009"><span class="annot"><span class="annottext">maxIndex :: Int
</span><a href="#local-6989586621679093009"><span class="hs-identifier hs-var hs-var">maxIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Int
forall a. Ord a =&gt; a -&gt; [a] -&gt; a
</span><a href="HoYo.Internal.Utils.html#maximumDefault"><span class="hs-identifier hs-var">maximumDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Int) -&gt; [Bookmark] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Int Bookmark Int -&gt; Bookmark -&gt; Int
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Int Bookmark Int
Lens' Bookmark Int
</span><a href="HoYo.Internal.Types.html#bookmarkIndex"><span class="hs-identifier hs-var">bookmarkIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093011"><span class="hs-identifier hs-var">bms</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span id="local-6989586621679093006"><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679093006"><span class="hs-identifier hs-var">zTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ZonedTime -&gt; HoYoMonad ZonedTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO ZonedTime
</span><span class="hs-identifier hs-var">getZonedTime</span></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093004"><span class="annot"><span class="annottext">newBookMark :: Bookmark
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var hs-var">newBookMark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Int -&gt; ZonedTime -&gt; Maybe TFilePath -&gt; Bookmark
</span><a href="HoYo.Internal.Types.html#Bookmark"><span class="hs-identifier hs-var">Bookmark</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093009"><span class="hs-identifier hs-var">maxIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ZonedTime
</span><a href="#local-6989586621679093006"><span class="hs-identifier hs-var">zTime</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath
</span><a href="#local-6989586621679093012"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bookmark
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var">newBookMark</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmark -&gt; [Bookmark] -&gt; [Bookmark]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093011"><span class="hs-identifier hs-var">bms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679093011"><span class="hs-identifier hs-var">bms</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Run the &quot;move&quot; command: search for a bookmark and @cd@ to it.</span><span>
</span><span id="line-244"></span><span class="annot"><a href="HoYo.Internal.Command.html#runMove"><span class="hs-identifier hs-type">runMove</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#MoveOptions"><span class="hs-identifier hs-type">MoveOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="runMove"><span class="annot"><span class="annottext">runMove :: MoveOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runMove"><span class="hs-identifier hs-var hs-var">runMove</span></a></span></span><span> </span><span id="local-6989586621679093000"><span class="annot"><span class="annottext">MoveOptions
</span><a href="#local-6989586621679093000"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679092999"><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092999"><span class="hs-identifier hs-var">bms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bookmarks -&gt; HoYoMonad Bookmarks
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bookmarks
Lens' Env Bookmarks
</span><a href="HoYo.Internal.Types.html#bookmarks"><span class="hs-identifier hs-var">bookmarks</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092996"><span class="annot"><span class="annottext">search :: BookmarkSearchTerm
</span><a href="#local-6989586621679092996"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MoveOptions -&gt; BookmarkSearchTerm
</span><a href="HoYo.Internal.Command.html#moveSearch"><span class="hs-identifier hs-var hs-var">moveSearch</span></a></span><span> </span><span class="annot"><span class="annottext">MoveOptions
</span><a href="#local-6989586621679093000"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Bookmark], [Bookmark]) -&gt; [Bookmark]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([Bookmark], [Bookmark]) -&gt; [Bookmark])
-&gt; ([Bookmark], [Bookmark]) -&gt; [Bookmark]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm -&gt; Bookmarks -&gt; ([Bookmark], [Bookmark])
</span><a href="HoYo.Internal.Bookmark.html#searchBookmarks"><span class="hs-identifier hs-var">searchBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm
</span><a href="#local-6989586621679092996"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092999"><span class="hs-identifier hs-var">bms</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;Unknown bookmark: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm -&gt; TFilePath
forall a. Show a =&gt; a -&gt; TFilePath
</span><a href="HoYo.Internal.Utils.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm
</span><a href="#local-6989586621679092996"><span class="hs-identifier hs-var">search</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679092993"><span class="annot"><span class="annottext">Bookmark
</span><a href="#local-6989586621679092993"><span class="hs-identifier hs-var">bm</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStdout"><span class="hs-identifier hs-var">printStdout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;cd &quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Getting TFilePath Bookmark TFilePath -&gt; Bookmark -&gt; TFilePath
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting TFilePath Bookmark TFilePath
Lens' Bookmark TFilePath
</span><a href="HoYo.Internal.Types.html#bookmarkDirectory"><span class="hs-identifier hs-var">bookmarkDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmark
</span><a href="#local-6989586621679092993"><span class="hs-identifier hs-var">bm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>                </span><span class="annot"><span class="annottext">IO () -&gt; HoYoMonad ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; HoYoMonad ()) -&gt; IO () -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExitCode -&gt; IO ()
forall a. ExitCode -&gt; IO a
</span><span class="hs-identifier hs-var">exitWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ExitCode
</span><span class="hs-identifier hs-var">ExitFailure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679092988"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092988"><span class="hs-identifier hs-var">ms</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679092987"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092987"><span class="hs-identifier hs-var">displayTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#displayCreationTime"><span class="hs-identifier hs-var">displayCreationTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092986"><span class="annot"><span class="annottext">strs :: [TFilePath]
</span><a href="#local-6989586621679092986"><span class="hs-identifier hs-var hs-var">strs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bookmark] -&gt; [TFilePath]
</span><a href="HoYo.Internal.Utils.html#formatBookmarks"><span class="hs-identifier hs-var">formatBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092987"><span class="hs-identifier hs-var">displayTime</span></a></span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [TFilePath]) -&gt; [Bookmark] -&gt; [TFilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Int) -&gt; [Bookmark] -&gt; [Bookmark]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Int Bookmark Int -&gt; Bookmark -&gt; Int
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Int Bookmark Int
Lens' Bookmark Int
</span><a href="HoYo.Internal.Types.html#bookmarkIndex"><span class="hs-identifier hs-var">bookmarkIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092988"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-254"></span><span>                </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; HoYoMonad ()) -&gt; TFilePath -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; [TFilePath] -&gt; TFilePath
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;multiple bookmarks matching search:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; [TFilePath] -&gt; [TFilePath]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TFilePath]
</span><a href="#local-6989586621679092986"><span class="hs-identifier hs-var">strs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Run the &quot;list&quot; command: list all the saved bookmarks.</span><span>
</span><span id="line-257"></span><span class="annot"><a href="HoYo.Internal.Command.html#runList"><span class="hs-identifier hs-type">runList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ListOptions"><span class="hs-identifier hs-type">ListOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span id="runList"><span class="annot"><span class="annottext">runList :: ListOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runList"><span class="hs-identifier hs-var hs-var">runList</span></a></span></span><span> </span><span id="local-6989586621679092981"><span class="annot"><span class="annottext">ListOptions
</span><a href="#local-6989586621679092981"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092980"><span class="annot"><span class="annottext">filt :: Bookmark -&gt; Bool
</span><a href="#local-6989586621679092980"><span class="hs-identifier hs-var hs-var">filt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath -&gt; Maybe TFilePath -&gt; Bookmark -&gt; Bool
</span><a href="HoYo.Internal.Bookmark.html#filterBookmarks"><span class="hs-identifier hs-var">filterBookmarks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#listFilterName"><span class="hs-identifier hs-var hs-var">listFilterName</span></a></span><span> </span><span class="annot"><span class="annottext">ListOptions
</span><a href="#local-6989586621679092981"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ListOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#listFilterDirectoryInfix"><span class="hs-identifier hs-var hs-var">listFilterDirectoryInfix</span></a></span><span> </span><span class="annot"><span class="annottext">ListOptions
</span><a href="#local-6989586621679092981"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679092978"><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092978"><span class="hs-identifier hs-var">bms'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bookmarks -&gt; HoYoMonad Bookmarks
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bookmarks
Lens' Env Bookmarks
</span><a href="HoYo.Internal.Types.html#bookmarks"><span class="hs-identifier hs-var">bookmarks</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092977"><span class="annot"><span class="annottext">bms :: [Bookmark]
</span><a href="#local-6989586621679092977"><span class="hs-identifier hs-var hs-var">bms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Bool) -&gt; [Bookmark] -&gt; [Bookmark]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Bookmark -&gt; Bool
</span><a href="#local-6989586621679092980"><span class="hs-identifier hs-var">filt</span></a></span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark]) -&gt; [Bookmark] -&gt; [Bookmark]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Int) -&gt; [Bookmark] -&gt; [Bookmark]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting Int Bookmark Int -&gt; Bookmark -&gt; Int
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Int Bookmark Int
Lens' Bookmark Int
</span><a href="HoYo.Internal.Types.html#bookmarkIndex"><span class="hs-identifier hs-var">bookmarkIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark]) -&gt; [Bookmark] -&gt; [Bookmark]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bookmarks -&gt; [Bookmark]
</span><a href="HoYo.Internal.Types.html#unBookmarks"><span class="hs-identifier hs-var hs-var">unBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092978"><span class="hs-identifier hs-var">bms'</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679092975"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092975"><span class="hs-identifier hs-var">displayTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#displayCreationTime"><span class="hs-identifier hs-var">displayCreationTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="annottext">(TFilePath -&gt; HoYoMonad ()) -&gt; [TFilePath] -&gt; HoYoMonad ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStdout"><span class="hs-identifier hs-var">printStdout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [Bookmark] -&gt; [TFilePath]
</span><a href="HoYo.Internal.Utils.html#formatBookmarks"><span class="hs-identifier hs-var">formatBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092975"><span class="hs-identifier hs-var">displayTime</span></a></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092977"><span class="hs-identifier hs-var">bms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Help text displayed when the user tries to run &quot;hoyo clear&quot;</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- when &quot;enable_clear&quot; is set to false.</span><span>
</span><span id="line-267"></span><span class="annot"><a href="HoYo.Internal.Command.html#clearDisabledErrMsg"><span class="hs-identifier hs-type">clearDisabledErrMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-268"></span><span id="clearDisabledErrMsg"><span class="annot"><span class="annottext">clearDisabledErrMsg :: TFilePath
</span><a href="HoYo.Internal.Command.html#clearDisabledErrMsg"><span class="hs-identifier hs-var hs-var">clearDisabledErrMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; [TFilePath] -&gt; TFilePath
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;The 'clear' command is disabled by default.&quot;</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;To enable, set enable_clear = true in the config or pass the --enable-clear flag.&quot;</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Help text displayed when the user tries to run &quot;hoyo config reset&quot;</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- when &quot;enable_reset&quot; is set to false.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="HoYo.Internal.Command.html#resetDisabledErrMsg"><span class="hs-identifier hs-type">resetDisabledErrMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-276"></span><span id="resetDisabledErrMsg"><span class="annot"><span class="annottext">resetDisabledErrMsg :: TFilePath
</span><a href="HoYo.Internal.Command.html#resetDisabledErrMsg"><span class="hs-identifier hs-var hs-var">resetDisabledErrMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; [TFilePath] -&gt; TFilePath
</span><span class="hs-identifier hs-var">T.intercalate</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">[</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;The 'config reset' command is disabled by default.&quot;</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;To enable, set enable_reset = true in the config or pass the --enable-reset flag.&quot;</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- | Run the &quot;clear&quot; command: delete all the saved bookmarks.</span><span>
</span><span id="line-282"></span><span class="annot"><a href="HoYo.Internal.Command.html#runClear"><span class="hs-identifier hs-type">runClear</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ClearOptions"><span class="hs-identifier hs-type">ClearOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span id="runClear"><span class="annot"><span class="annottext">runClear :: ClearOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runClear"><span class="hs-identifier hs-var hs-var">runClear</span></a></span></span><span> </span><span class="annot"><span class="annottext">ClearOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Utils.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="HoYo.Internal.Command.html#clearDisabledErrMsg"><span class="hs-identifier hs-var">clearDisabledErrMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#enableClearing"><span class="hs-identifier hs-var">enableClearing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679092970"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092970"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath -&gt; HoYoMonad TFilePath
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath
Lens' Env TFilePath
</span><a href="HoYo.Internal.Types.html#bookmarksPath"><span class="hs-identifier hs-var">bookmarksPath</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679092968"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092968"><span class="hs-identifier hs-var">backup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#backupBeforeClear"><span class="hs-identifier hs-var">backupBeforeClear</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad () -&gt; HoYoMonad ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092968"><span class="hs-identifier hs-var">backup</span></a></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad () -&gt; HoYoMonad ()) -&gt; HoYoMonad () -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; String -&gt; HoYoMonad ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError TFilePath m) =&gt;
TFilePath -&gt; String -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#backupFile"><span class="hs-identifier hs-var">backupFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092970"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bkp&quot;</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarks"><span class="hs-identifier hs-var">modifyBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">(([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ())
-&gt; ([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; [Bookmark] -&gt; [Bookmark]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679092964"><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092964"><span class="hs-identifier hs-var">bms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env [DefaultBookmark] -&gt; HoYoMonad [DefaultBookmark]
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; (([DefaultBookmark] -&gt; Const r [DefaultBookmark])
    -&gt; Config -&gt; Const r Config)
-&gt; ([DefaultBookmark] -&gt; Const r [DefaultBookmark])
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([DefaultBookmark] -&gt; Const r [DefaultBookmark])
-&gt; Config -&gt; Const r Config
Lens' Config [DefaultBookmark]
</span><a href="HoYo.Internal.Utils.html#defaultBookmarks"><span class="hs-identifier hs-var">defaultBookmarks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HoYoMonad [DefaultBookmark]
-&gt; ([DefaultBookmark] -&gt; HoYoMonad Bookmarks)
-&gt; HoYoMonad Bookmarks
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[DefaultBookmark] -&gt; HoYoMonad Bookmarks
forall (m :: * -&gt; *). MonadIO m =&gt; [DefaultBookmark] -&gt; m Bookmarks
</span><a href="HoYo.Internal.Bookmark.html#bookmarksFromDefault"><span class="hs-identifier hs-var">bookmarksFromDefault</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679092961"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092961"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath -&gt; HoYoMonad TFilePath
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath
Lens' Env TFilePath
</span><a href="HoYo.Internal.Types.html#bookmarksPath"><span class="hs-identifier hs-var">bookmarksPath</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; Bookmarks -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; Bookmarks -&gt; m ()
</span><a href="HoYo.Internal.Bookmark.html#encodeBookmarksFile"><span class="hs-identifier hs-var">encodeBookmarksFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092961"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Bookmarks
</span><a href="#local-6989586621679092964"><span class="hs-identifier hs-var">bms</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Run the &quot;delete&quot; command: search for a bookmark and delete it.</span><span>
</span><span id="line-296"></span><span class="annot"><a href="HoYo.Internal.Command.html#runDelete"><span class="hs-identifier hs-type">runDelete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#DeleteOptions"><span class="hs-identifier hs-type">DeleteOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span id="runDelete"><span class="annot"><span class="annottext">runDelete :: DeleteOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runDelete"><span class="hs-identifier hs-var hs-var">runDelete</span></a></span></span><span> </span><span id="local-6989586621679092959"><span class="annot"><span class="annottext">DeleteOptions
</span><a href="#local-6989586621679092959"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092958"><span class="annot"><span class="annottext">search :: BookmarkSearchTerm
</span><a href="#local-6989586621679092958"><span class="hs-identifier hs-var hs-var">search</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeleteOptions -&gt; BookmarkSearchTerm
</span><a href="HoYo.Internal.Command.html#deleteSearch"><span class="hs-identifier hs-var hs-var">deleteSearch</span></a></span><span> </span><span class="annot"><span class="annottext">DeleteOptions
</span><a href="#local-6989586621679092959"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarksM"><span class="hs-identifier hs-var">modifyBookmarksM</span></a></span><span> </span><span class="annot"><span class="annottext">(([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ())
-&gt; ([Bookmark] -&gt; HoYoMonad [Bookmark]) -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679092957"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092957"><span class="hs-identifier hs-var">bms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679092956"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092956"><span class="hs-identifier hs-var">searchResults</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679092955"><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092955"><span class="hs-identifier hs-var">afterDelete</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm -&gt; Bookmarks -&gt; ([Bookmark], [Bookmark])
</span><a href="HoYo.Internal.Bookmark.html#searchBookmarks"><span class="hs-identifier hs-var">searchBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm
</span><a href="#local-6989586621679092958"><span class="hs-identifier hs-var">search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bookmark] -&gt; Bookmarks
</span><a href="HoYo.Internal.Types.html#Bookmarks"><span class="hs-identifier hs-var">Bookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092957"><span class="hs-identifier hs-var">bms</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Utils.html#assertVerbose"><span class="hs-identifier hs-var">assertVerbose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;no bookmarks found for search &quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm -&gt; TFilePath
forall a. Show a =&gt; a -&gt; TFilePath
</span><a href="HoYo.Internal.Utils.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm
</span><a href="#local-6989586621679092958"><span class="hs-identifier hs-var">search</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad Bool)
-&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HoYoMonad Bool) -&gt; Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092956"><span class="hs-identifier hs-var">searchResults</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
</span><a href="HoYo.Internal.Utils.html#assertVerbose"><span class="hs-identifier hs-var">assertVerbose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;multiple bookmarks found for search &quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm -&gt; TFilePath
forall a. Show a =&gt; a -&gt; TFilePath
</span><a href="HoYo.Internal.Utils.html#tshow"><span class="hs-identifier hs-var">tshow</span></a></span><span> </span><span class="annot"><span class="annottext">BookmarkSearchTerm
</span><a href="#local-6989586621679092958"><span class="hs-identifier hs-var">search</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">(HoYoMonad Bool -&gt; HoYoMonad Bool)
-&gt; HoYoMonad Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HoYoMonad Bool) -&gt; Bool -&gt; HoYoMonad Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092956"><span class="hs-identifier hs-var">searchResults</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">[Bookmark] -&gt; HoYoMonad [Bookmark]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[Bookmark]
</span><a href="#local-6989586621679092955"><span class="hs-identifier hs-var">afterDelete</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Run the &quot;refresh&quot; command: re-index bookmarks.</span><span>
</span><span id="line-308"></span><span class="annot"><a href="HoYo.Internal.Command.html#runRefresh"><span class="hs-identifier hs-type">runRefresh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#RefreshOptions"><span class="hs-identifier hs-type">RefreshOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span id="runRefresh"><span class="annot"><span class="annottext">runRefresh :: RefreshOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runRefresh"><span class="hs-identifier hs-var hs-var">runRefresh</span></a></span></span><span> </span><span class="annot"><span class="annottext">RefreshOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#modifyBookmarks"><span class="hs-identifier hs-var">modifyBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">(([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ())
-&gt; ([Bookmark] -&gt; [Bookmark]) -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; Bookmark -&gt; Bookmark) -&gt; [Int] -&gt; [Bookmark] -&gt; [Bookmark]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASetter Bookmark Bookmark Int Int -&gt; Int -&gt; Bookmark -&gt; Bookmark
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">ASetter Bookmark Bookmark Int Int
Lens' Bookmark Int
</span><a href="HoYo.Internal.Types.html#bookmarkIndex"><span class="hs-identifier hs-var">bookmarkIndex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>                           </span><span class="hs-comment">-- re-index from 1</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark])
-&gt; ([Bookmark] -&gt; [Bookmark]) -&gt; [Bookmark] -&gt; [Bookmark]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; Bookmark -&gt; Bool) -&gt; [Bookmark] -&gt; [Bookmark]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nubBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; TFilePath -&gt; Bool)
-&gt; (Bookmark -&gt; TFilePath) -&gt; Bookmark -&gt; Bookmark -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Getting TFilePath Bookmark TFilePath -&gt; Bookmark -&gt; TFilePath
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting TFilePath Bookmark TFilePath
Lens' Bookmark TFilePath
</span><a href="HoYo.Internal.Types.html#bookmarkDirectory"><span class="hs-identifier hs-var">bookmarkDirectory</span></a></span><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- remove duplicate directories</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">([Bookmark] -&gt; [Bookmark])
-&gt; ([Bookmark] -&gt; [Bookmark]) -&gt; [Bookmark] -&gt; [Bookmark]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bookmark -&gt; UTCTime) -&gt; [Bookmark] -&gt; [Bookmark]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZonedTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">zonedTimeToUTC</span></span><span> </span><span class="annot"><span class="annottext">(ZonedTime -&gt; UTCTime)
-&gt; (Bookmark -&gt; ZonedTime) -&gt; Bookmark -&gt; UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting ZonedTime Bookmark ZonedTime -&gt; Bookmark -&gt; ZonedTime
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting ZonedTime Bookmark ZonedTime
Lens' Bookmark ZonedTime
</span><a href="HoYo.Internal.Types.html#bookmarkCreationTime"><span class="hs-identifier hs-var">bookmarkCreationTime</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- sort by creation time</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Run the &quot;config print&quot; command: print the current config.</span><span>
</span><span id="line-315"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfigPrint"><span class="hs-identifier hs-type">runConfigPrint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigPrintOptions"><span class="hs-identifier hs-type">ConfigPrintOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span id="runConfigPrint"><span class="annot"><span class="annottext">runConfigPrint :: ConfigPrintOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigPrint"><span class="hs-identifier hs-var hs-var">runConfigPrint</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConfigPrintOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679092944"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679092944"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Config -&gt; HoYoMonad Config
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Config
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092943"><span class="annot"><span class="annottext">keyVals :: [(TFilePath, AnyConfigValue)]
</span><a href="#local-6989586621679092943"><span class="hs-identifier hs-var hs-var">keyVals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; [(TFilePath, AnyConfigValue)]
</span><a href="HoYo.Internal.Config.html#getKeyVals"><span class="hs-identifier hs-var">getKeyVals</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679092944"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092941"><span class="annot"><span class="annottext">keyWidth :: Int
</span><a href="#local-6989586621679092941"><span class="hs-identifier hs-var hs-var">keyWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((TFilePath, AnyConfigValue) -&gt; Int)
-&gt; [(TFilePath, AnyConfigValue)] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TFilePath -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; Int)
-&gt; ((TFilePath, AnyConfigValue) -&gt; TFilePath)
-&gt; (TFilePath, AnyConfigValue)
-&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TFilePath, AnyConfigValue) -&gt; TFilePath
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(TFilePath, AnyConfigValue)]
</span><a href="#local-6989586621679092943"><span class="hs-identifier hs-var">keyVals</span></a></span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="annottext">[(TFilePath, AnyConfigValue)]
-&gt; ((TFilePath, AnyConfigValue) -&gt; HoYoMonad ()) -&gt; HoYoMonad ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[(TFilePath, AnyConfigValue)]
</span><a href="#local-6989586621679092943"><span class="hs-identifier hs-var">keyVals</span></a></span><span> </span><span class="annot"><span class="annottext">(((TFilePath, AnyConfigValue) -&gt; HoYoMonad ()) -&gt; HoYoMonad ())
-&gt; ((TFilePath, AnyConfigValue) -&gt; HoYoMonad ()) -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679092937"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092937"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679092936"><span class="annot"><span class="annottext">AnyConfigValue
</span><a href="#local-6989586621679092936"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092935"><span class="annot"><span class="annottext">vStr :: TFilePath
</span><a href="#local-6989586621679092935"><span class="hs-identifier hs-var hs-var">vStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnyConfigValue -&gt; TFilePath
</span><a href="HoYo.Internal.Utils.html#formatConfigValue"><span class="hs-identifier hs-var">formatConfigValue</span></a></span><span> </span><span class="annot"><span class="annottext">AnyConfigValue
</span><a href="#local-6989586621679092936"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStdout"><span class="hs-identifier hs-var">printStdout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; TFilePath -&gt; TFilePath
</span><span class="hs-identifier hs-var">T.justifyLeft</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092941"><span class="hs-identifier hs-var">keyWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092937"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; TFilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092935"><span class="hs-identifier hs-var">vStr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Run the &quot;config reset&quot; command: reset the config to 'defaultConfig'.</span><span>
</span><span id="line-325"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfigReset"><span class="hs-identifier hs-type">runConfigReset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigResetOptions"><span class="hs-identifier hs-type">ConfigResetOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="runConfigReset"><span class="annot"><span class="annottext">runConfigReset :: ConfigResetOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigReset"><span class="hs-identifier hs-var hs-var">runConfigReset</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConfigResetOptions
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad Bool -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Utils.html#assert"><span class="hs-identifier hs-var">assert</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="HoYo.Internal.Command.html#resetDisabledErrMsg"><span class="hs-identifier hs-var">resetDisabledErrMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#enableReset"><span class="hs-identifier hs-var">enableReset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679092931"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092931"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath -&gt; HoYoMonad TFilePath
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath
Lens' Env TFilePath
</span><a href="HoYo.Internal.Types.html#configPath"><span class="hs-identifier hs-var">configPath</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679092929"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092929"><span class="hs-identifier hs-var">backup</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Bool -&gt; HoYoMonad Bool
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config)
-&gt; (Bool -&gt; Const r Bool)
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Const r Bool) -&gt; Config -&gt; Const r Config
Lens' Config Bool
</span><a href="HoYo.Internal.Utils.html#backupBeforeClear"><span class="hs-identifier hs-var">backupBeforeClear</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; HoYoMonad () -&gt; HoYoMonad ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679092929"><span class="hs-identifier hs-var">backup</span></a></span><span> </span><span class="annot"><span class="annottext">(HoYoMonad () -&gt; HoYoMonad ()) -&gt; HoYoMonad () -&gt; HoYoMonad ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; String -&gt; HoYoMonad ()
forall (m :: * -&gt; *).
(MonadIO m, MonadError TFilePath m) =&gt;
TFilePath -&gt; String -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#backupFile"><span class="hs-identifier hs-var">backupFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092931"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bkp&quot;</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">TFilePath -&gt; Config -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; Config -&gt; m ()
</span><a href="HoYo.Internal.Config.html#encodeConfigFile"><span class="hs-identifier hs-var">encodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092931"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="HoYo.Internal.Config.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | Run the &quot;config set&quot; command: try to set a key-value pair in the config.</span><span>
</span><span id="line-337"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfigSet"><span class="hs-identifier hs-type">runConfigSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigSetOptions"><span class="hs-identifier hs-type">ConfigSetOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="runConfigSet"><span class="annot"><span class="annottext">runConfigSet :: ConfigSetOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigSet"><span class="hs-identifier hs-var hs-var">runConfigSet</span></a></span></span><span> </span><span id="local-6989586621679092925"><span class="annot"><span class="annottext">ConfigSetOptions
</span><a href="#local-6989586621679092925"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092924"><span class="annot"><span class="annottext">key :: TFilePath
</span><a href="#local-6989586621679092924"><span class="hs-identifier hs-var hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#setKey"><span class="hs-identifier hs-var hs-var">setKey</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions
</span><a href="#local-6989586621679092925"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092923"><span class="annot"><span class="annottext">val :: TFilePath
</span><a href="#local-6989586621679092923"><span class="hs-identifier hs-var hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#setValue"><span class="hs-identifier hs-var hs-var">setValue</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions
</span><a href="#local-6989586621679092925"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679092922"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092922"><span class="hs-identifier hs-var">cfgPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath -&gt; HoYoMonad TFilePath
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath
Lens' Env TFilePath
</span><a href="HoYo.Internal.Types.html#configPath"><span class="hs-identifier hs-var">configPath</span></a></span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">SimpleGetter Env Config -&gt; HoYoMonad Config
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Config
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">HoYoMonad Config
-&gt; (Config -&gt; HoYoMonad Config) -&gt; HoYoMonad Config
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; TFilePath -&gt; Config -&gt; HoYoMonad Config
forall (m :: * -&gt; *).
MonadError TFilePath m =&gt;
TFilePath -&gt; TFilePath -&gt; Config -&gt; m Config
</span><a href="HoYo.Internal.Config.html#setConfig"><span class="hs-identifier hs-var">setConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092924"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092923"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><span class="annottext">HoYoMonad Config -&gt; (Config -&gt; HoYoMonad ()) -&gt; HoYoMonad ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Config -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; Config -&gt; m ()
</span><a href="HoYo.Internal.Config.html#encodeConfigFile"><span class="hs-identifier hs-var">encodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092922"><span class="hs-identifier hs-var">cfgPath</span></a></span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Run the &quot;config add-default&quot; command: try to set a key-value pair in the config.</span><span>
</span><span id="line-347"></span><span class="annot"><a href="HoYo.Internal.Command.html#runAddDefault"><span class="hs-identifier hs-type">runAddDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigAddDefaultOptions"><span class="hs-identifier hs-type">ConfigAddDefaultOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span id="runAddDefault"><span class="annot"><span class="annottext">runAddDefault :: ConfigAddDefaultOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runAddDefault"><span class="hs-identifier hs-var hs-var">runAddDefault</span></a></span></span><span> </span><span id="local-6989586621679092919"><span class="annot"><span class="annottext">ConfigAddDefaultOptions
</span><a href="#local-6989586621679092919"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679092918"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092918"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad TFilePath
</span><a href="HoYo.Internal.Command.html#normaliseAndVerifyDirectory"><span class="hs-identifier hs-var">normaliseAndVerifyDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; HoYoMonad TFilePath)
-&gt; TFilePath -&gt; HoYoMonad TFilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; TFilePath
</span><a href="HoYo.Internal.Command.html#addDefaultDir"><span class="hs-identifier hs-var hs-var">addDefaultDir</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions
</span><a href="#local-6989586621679092919"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092917"><span class="annot"><span class="annottext">name :: Maybe TFilePath
</span><a href="#local-6989586621679092917"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; Maybe TFilePath
</span><a href="HoYo.Internal.Command.html#addDefaultName"><span class="hs-identifier hs-var hs-var">addDefaultName</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions
</span><a href="#local-6989586621679092919"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092916"><span class="annot"><span class="annottext">defaultBm :: DefaultBookmark
</span><a href="#local-6989586621679092916"><span class="hs-identifier hs-var hs-var">defaultBm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Maybe TFilePath -&gt; DefaultBookmark
</span><a href="HoYo.Internal.Types.html#DefaultBookmark"><span class="hs-identifier hs-var">DefaultBookmark</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092918"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TFilePath
</span><a href="#local-6989586621679092917"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679092914"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092914"><span class="hs-identifier hs-var">cfgPath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath -&gt; HoYoMonad TFilePath
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env TFilePath
Lens' Env TFilePath
</span><a href="HoYo.Internal.Types.html#configPath"><span class="hs-identifier hs-var">configPath</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><span class="annottext">SimpleGetter Env Config -&gt; HoYoMonad Config
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env Config
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">HoYoMonad Config -&gt; (Config -&gt; HoYoMonad ()) -&gt; HoYoMonad ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; Config -&gt; HoYoMonad ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; Config -&gt; m ()
</span><a href="HoYo.Internal.Config.html#encodeConfigFile"><span class="hs-identifier hs-var">encodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092914"><span class="hs-identifier hs-var">cfgPath</span></a></span><span> </span><span class="annot"><span class="annottext">(Config -&gt; HoYoMonad ())
-&gt; (Config -&gt; Config) -&gt; Config -&gt; HoYoMonad ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config [DefaultBookmark] [DefaultBookmark]
-&gt; ([DefaultBookmark] -&gt; [DefaultBookmark]) -&gt; Config -&gt; Config
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">ASetter Config Config [DefaultBookmark] [DefaultBookmark]
Lens' Config [DefaultBookmark]
</span><a href="HoYo.Internal.Utils.html#defaultBookmarks"><span class="hs-identifier hs-var">defaultBookmarks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefaultBookmark
</span><a href="#local-6989586621679092916"><span class="hs-identifier hs-var">defaultBm</span></a></span><span> </span><span class="annot"><span class="annottext">DefaultBookmark -&gt; [DefaultBookmark] -&gt; [DefaultBookmark]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Run the &quot;config&quot; command: dispatch on the given sub-command.</span><span>
</span><span id="line-358"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-type">runConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigCommand"><span class="hs-identifier hs-type">ConfigCommand</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span id="runConfig"><span class="annot"><span class="annottext">runConfig :: ConfigCommand -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-var hs-var">runConfig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Print"><span class="hs-identifier hs-type">Print</span></a></span><span> </span><span id="local-6989586621679092912"><span class="annot"><span class="annottext">ConfigPrintOptions
</span><a href="#local-6989586621679092912"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigPrintOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigPrint"><span class="hs-identifier hs-var">runConfigPrint</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigPrintOptions
</span><a href="#local-6989586621679092912"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-360"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-var">runConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Reset"><span class="hs-identifier hs-type">Reset</span></a></span><span> </span><span id="local-6989586621679092911"><span class="annot"><span class="annottext">ConfigResetOptions
</span><a href="#local-6989586621679092911"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigResetOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigReset"><span class="hs-identifier hs-var">runConfigReset</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigResetOptions
</span><a href="#local-6989586621679092911"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-361"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-var">runConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span id="local-6989586621679092910"><span class="annot"><span class="annottext">ConfigSetOptions
</span><a href="#local-6989586621679092910"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfigSet"><span class="hs-identifier hs-var">runConfigSet</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigSetOptions
</span><a href="#local-6989586621679092910"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-362"></span><span class="annot"><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-var">runConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#AddDefaultBookmark"><span class="hs-identifier hs-type">AddDefaultBookmark</span></a></span><span> </span><span id="local-6989586621679092909"><span class="annot"><span class="annottext">ConfigAddDefaultOptions
</span><a href="#local-6989586621679092909"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runAddDefault"><span class="hs-identifier hs-var">runAddDefault</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigAddDefaultOptions
</span><a href="#local-6989586621679092909"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-comment">-- | Check that the config file is valid.</span><span>
</span><span id="line-365"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCheckConfig"><span class="hs-identifier hs-type">runCheckConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span id="runCheckConfig"><span class="annot"><span class="annottext">runCheckConfig :: TFilePath -&gt; IO ()
</span><a href="HoYo.Internal.Command.html#runCheckConfig"><span class="hs-identifier hs-var hs-var">runCheckConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO (Either TFilePath Config)
forall (m :: * -&gt; *).
MonadIO m =&gt;
TFilePath -&gt; m (Either TFilePath Config)
</span><a href="HoYo.Internal.Config.html#decodeConfigFile"><span class="hs-identifier hs-var">decodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; IO (Either TFilePath Config))
-&gt; (Either TFilePath Config -&gt; IO ()) -&gt; TFilePath -&gt; IO ()
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679092905"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092905"><span class="hs-identifier hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStderr"><span class="hs-identifier hs-var">printStderr</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092905"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStdout"><span class="hs-identifier hs-var">printStdout</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;Config is good&quot;</span></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- | Check that the bookmarks file is valid.</span><span>
</span><span id="line-371"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCheckBookmarks"><span class="hs-identifier hs-type">runCheckBookmarks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span id="runCheckBookmarks"><span class="annot"><span class="annottext">runCheckBookmarks :: TFilePath -&gt; IO ()
</span><a href="HoYo.Internal.Command.html#runCheckBookmarks"><span class="hs-identifier hs-var hs-var">runCheckBookmarks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO (Either TFilePath Bookmarks)
forall (m :: * -&gt; *).
MonadIO m =&gt;
TFilePath -&gt; m (Either TFilePath Bookmarks)
</span><a href="HoYo.Internal.Bookmark.html#decodeBookmarksFile"><span class="hs-identifier hs-var">decodeBookmarksFile</span></a></span><span> </span><span class="annot"><span class="annottext">(TFilePath -&gt; IO (Either TFilePath Bookmarks))
-&gt; (Either TFilePath Bookmarks -&gt; IO ()) -&gt; TFilePath -&gt; IO ()
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679092901"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092901"><span class="hs-identifier hs-var">err</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStderr"><span class="hs-identifier hs-var">printStderr</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092901"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bookmarks
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; TFilePath -&gt; m ()
</span><a href="HoYo.Internal.Utils.html#printStdout"><span class="hs-identifier hs-var">printStdout</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;Bookmarks file is good&quot;</span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Run the &quot;config check&quot; command: validate the current</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- config and bookmarks files.</span><span>
</span><span id="line-378"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCheck"><span class="hs-identifier hs-type">runCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#CheckOptions"><span class="hs-identifier hs-type">CheckOptions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#TFilePath"><span class="hs-identifier hs-type">TFilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span id="runCheck"><span class="annot"><span class="annottext">runCheck :: CheckOptions -&gt; TFilePath -&gt; TFilePath -&gt; IO ()
</span><a href="HoYo.Internal.Command.html#runCheck"><span class="hs-identifier hs-var hs-var">runCheck</span></a></span></span><span> </span><span id="local-6989586621679092899"><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679092899"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679092898"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092898"><span class="hs-identifier hs-var">bFp</span></a></span></span><span> </span><span id="local-6989586621679092897"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092897"><span class="hs-identifier hs-var">sFp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckOptions -&gt; Bool
</span><a href="HoYo.Internal.Command.html#checkConfig"><span class="hs-identifier hs-var hs-var">checkConfig</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679092899"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
</span><a href="HoYo.Internal.Command.html#runCheckConfig"><span class="hs-identifier hs-var">runCheckConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092897"><span class="hs-identifier hs-var">sFp</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckOptions -&gt; Bool
</span><a href="HoYo.Internal.Command.html#checkBookmarks"><span class="hs-identifier hs-var hs-var">checkBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><a href="#local-6989586621679092899"><span class="hs-identifier hs-var">opts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; IO ()
</span><a href="HoYo.Internal.Command.html#runCheckBookmarks"><span class="hs-identifier hs-var">runCheckBookmarks</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092898"><span class="hs-identifier hs-var">bFp</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Run the default command, if it has been specified by the user.</span><span>
</span><span id="line-384"></span><span class="annot"><a href="HoYo.Internal.Command.html#runDefaultCommand"><span class="hs-identifier hs-type">runDefaultCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#ExecResult"><span class="hs-identifier hs-type">ExecResult</span></a></span><span>
</span><span id="line-385"></span><span id="runDefaultCommand"><span class="annot"><span class="annottext">runDefaultCommand :: HoYoMonad ExecResult
</span><a href="HoYo.Internal.Command.html#runDefaultCommand"><span class="hs-identifier hs-var hs-var">runDefaultCommand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleGetter Env (Maybe TFilePath) -&gt; HoYoMonad (Maybe TFilePath)
forall a (m :: * -&gt; *) b.
MonadReader a m =&gt;
SimpleGetter a b -&gt; m b
</span><a href="HoYo.Internal.Utils.html#asks%27"><span class="hs-identifier hs-var">asks'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env
Lens' Env Config
</span><a href="HoYo.Internal.Types.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">((Config -&gt; Const r Config) -&gt; Env -&gt; Const r Env)
-&gt; ((Maybe TFilePath -&gt; Const r (Maybe TFilePath))
    -&gt; Config -&gt; Const r Config)
-&gt; (Maybe TFilePath -&gt; Const r (Maybe TFilePath))
-&gt; Env
-&gt; Const r Env
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe TFilePath -&gt; Const r (Maybe TFilePath))
-&gt; Config -&gt; Const r Config
Lens' Config (Maybe TFilePath)
</span><a href="HoYo.Internal.Utils.html#defaultCommand"><span class="hs-identifier hs-var">defaultCommand</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HoYoMonad (Maybe TFilePath)
-&gt; (Maybe TFilePath -&gt; HoYoMonad ExecResult)
-&gt; HoYoMonad ExecResult
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">Maybe TFilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExecResult -&gt; HoYoMonad ExecResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ExecResult
</span><a href="HoYo.Internal.Types.html#ShowHelp"><span class="hs-identifier hs-var">ShowHelp</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679092893"><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092893"><span class="hs-identifier hs-var">cmd</span></a></span></span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TFilePath] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([TFilePath] -&gt; Bool) -&gt; [TFilePath] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; [TFilePath]
</span><span class="hs-identifier hs-var">T.words</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092893"><span class="hs-identifier hs-var">cmd</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ExecResult
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;default command: stuck in a loop!&quot;</span></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExecResult -&gt; HoYoMonad ExecResult
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ExecResult -&gt; HoYoMonad ExecResult)
-&gt; ExecResult -&gt; HoYoMonad ExecResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; ExecResult
</span><a href="HoYo.Internal.Types.html#ReRun"><span class="hs-identifier hs-var">ReRun</span></a></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><a href="#local-6989586621679092893"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Run a 'Command' in the hoyo environment.</span><span>
</span><span id="line-392"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-type">runCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HoYo.Internal.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HoYo.Internal.Types.html#HoYoMonad"><span class="hs-identifier hs-type">HoYoMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span id="runCommand"><span class="annot"><span class="annottext">runCommand :: Command -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var hs-var">runCommand</span></a></span></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Add"><span class="hs-identifier hs-type">Add</span></a></span><span> </span><span id="local-6989586621679092889"><span class="annot"><span class="annottext">AddOptions
</span><a href="#local-6989586621679092889"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runAdd"><span class="hs-identifier hs-var">runAdd</span></a></span><span> </span><span class="annot"><span class="annottext">AddOptions
</span><a href="#local-6989586621679092889"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-394"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Move"><span class="hs-identifier hs-type">Move</span></a></span><span> </span><span id="local-6989586621679092888"><span class="annot"><span class="annottext">MoveOptions
</span><a href="#local-6989586621679092888"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MoveOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runMove"><span class="hs-identifier hs-var">runMove</span></a></span><span> </span><span class="annot"><span class="annottext">MoveOptions
</span><a href="#local-6989586621679092888"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-395"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span id="local-6989586621679092887"><span class="annot"><span class="annottext">ListOptions
</span><a href="#local-6989586621679092887"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ListOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runList"><span class="hs-identifier hs-var">runList</span></a></span><span> </span><span class="annot"><span class="annottext">ListOptions
</span><a href="#local-6989586621679092887"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-396"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Clear"><span class="hs-identifier hs-type">Clear</span></a></span><span> </span><span id="local-6989586621679092886"><span class="annot"><span class="annottext">ClearOptions
</span><a href="#local-6989586621679092886"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClearOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runClear"><span class="hs-identifier hs-var">runClear</span></a></span><span> </span><span class="annot"><span class="annottext">ClearOptions
</span><a href="#local-6989586621679092886"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-397"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Delete"><span class="hs-identifier hs-type">Delete</span></a></span><span> </span><span id="local-6989586621679092885"><span class="annot"><span class="annottext">DeleteOptions
</span><a href="#local-6989586621679092885"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeleteOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runDelete"><span class="hs-identifier hs-var">runDelete</span></a></span><span> </span><span class="annot"><span class="annottext">DeleteOptions
</span><a href="#local-6989586621679092885"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-398"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Refresh"><span class="hs-identifier hs-type">Refresh</span></a></span><span> </span><span id="local-6989586621679092884"><span class="annot"><span class="annottext">RefreshOptions
</span><a href="#local-6989586621679092884"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RefreshOptions -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runRefresh"><span class="hs-identifier hs-var">runRefresh</span></a></span><span> </span><span class="annot"><span class="annottext">RefreshOptions
</span><a href="#local-6989586621679092884"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-399"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#ConfigCmd"><span class="hs-identifier hs-type">ConfigCmd</span></a></span><span> </span><span id="local-6989586621679092883"><span class="annot"><span class="annottext">ConfigCommand
</span><a href="#local-6989586621679092883"><span class="hs-identifier hs-var">opts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConfigCommand -&gt; HoYoMonad ()
</span><a href="HoYo.Internal.Command.html#runConfig"><span class="hs-identifier hs-var">runConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ConfigCommand
</span><a href="#local-6989586621679092883"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-400"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>   </span><span class="annot"><span class="annottext">Command
</span><a href="HoYo.Internal.Command.html#DefaultCommand"><span class="hs-identifier hs-var">DefaultCommand</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HoYoMonad ExecResult -&gt; HoYoMonad ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">HoYoMonad ExecResult
</span><a href="HoYo.Internal.Command.html#runDefaultCommand"><span class="hs-identifier hs-var">runDefaultCommand</span></a></span><span>
</span><span id="line-401"></span><span class="annot"><a href="HoYo.Internal.Command.html#runCommand"><span class="hs-identifier hs-var">runCommand</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="HoYo.Internal.Command.html#Check"><span class="hs-identifier hs-type">Check</span></a></span><span> </span><span class="annot"><span class="annottext">CheckOptions
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TFilePath -&gt; HoYoMonad ()
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">TFilePath
</span><span class="hs-string">&quot;The 'check' command needs to be run outside the HoYo monad&quot;</span></span><span>
</span><span id="line-402"></span></pre></body></html>